{% extends 'base/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Tarbiyyah" %}{% endblock %}

{% block extra_head %}
<!-- Include component styles and behaviors -->
{% include 'components/design-system/color_palette.html' %}
{% include 'components/behaviors/common_behaviors.html' %}
{% include 'components/animations/scroll_animations.html' %}

<!-- Service Cards Highlighting Styles and Logic -->
<style>
    .service-card {
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transform: scale(1);
        transition: all 300ms cubic-bezier(0.25, 0.1, 0.25, 1);
    }

    .service-card.is-center {
        transform: scale(0.8);
        box-shadow: 0 4px 12px rgba(5, 150, 105, 0.15);
        border-color: rgba(5, 150, 105, 0.2);
    }

    .service-card.is-highlighted {
        transform: scale(1.05);
        box-shadow: 0 20px 40px rgba(5, 150, 105, 0.3), 0 0 30px rgba(5, 150, 105, 0.2);
        border-color: rgba(5, 150, 105, 0.4);
        z-index: 10;
        position: relative;
    }

    .service-card:not(.is-center):not(.is-highlighted) {
        transform: scale(0.8);
        opacity: 0.6;
    }

    /* Hero Image Blending */
    .hero-image-container {
        background: transparent;
    }

    .hero-image-container img {
        width: 100%;
        height: auto;
        max-height: 450px;
    }
</style>

<script>
    document.addEventListener('alpine:init', () => {
        Alpine.data('serviceCards', () => ({
            highlightedIndex: 1, // Center card (Explore Programs) highlighted by default

            init() {
                // Set initial highlighted state on center card
                this.applyHighlighting();
            },

            highlightCard(index) {
                this.highlightedIndex = index;
                this.applyHighlighting();
            },

            clearHighlight() {
                // Reset to center card (index 1) as default
                this.highlightedIndex = 1;
                this.applyHighlighting();
            },

            applyHighlighting() {
                // Get all service cards
                const cards = document.querySelectorAll('.service-card');
                cards.forEach((card, index) => {
                    // Remove all highlight classes
                    card.classList.remove('is-highlighted', 'is-center');

                    // Apply appropriate classes
                    if (index === this.highlightedIndex) {
                        card.classList.add('is-highlighted');
                        // Keep center card styling if it's the center position
                        if (index === 1) {
                            card.classList.add('is-center');
                        }
                    }
                });
            }
        }));
    });
</script>
{% endblock %}

{% block hero %}
<!-- Hero Section -->
<section class="relative overflow-hidden" style="background: linear-gradient(135deg, #1e40af 0%, #059669 100%);">
    <!-- Background decorative elements -->
    <div class="absolute inset-0 opacity-20">
        <div class="absolute top-0 left-10 w-40 h-40 bg-white rounded-full blur-3xl opacity-10"></div>
        <div class="absolute bottom-0 right-10 w-32 h-32 bg-white rounded-full blur-3xl opacity-10"></div>
        <div class="absolute top-1/2 right-1/4 w-24 h-24 bg-white rounded-full blur-2xl opacity-5"></div>
    </div>

    <!-- Subtle pattern overlay -->
    <div class="absolute inset-0 opacity-5" style="background-image: radial-gradient(circle at 20% 50%, rgba(30, 64, 175, 0.4) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(5, 150, 105, 0.4) 0%, transparent 50%);"></div>

    <!-- Main Content -->
    <div class="container mx-auto px-4 md:px-8 pt-8 md:pt-16 pb-0 relative z-10 max-w-7xl">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-0">
            <!-- Right Column: Content -->
            <div class="flex flex-col justify-center order-2 md:order-2 text-white">
                <h1 class="text-4xl md:text-5xl font-bold mb-4 leading-tight drop-shadow-lg">
                    {% trans 'Tarbiyyah' %}
                </h1>

                <h3 class="text-3xl md:text-4xl font-semibold mb-6 text-primary-50 drop-shadow-lg">
                    {% trans 'Serving the Bangsamoro with Integrity and Purpose.' %}
                </h3>

                <!-- Action Buttons -->
                <div class="flex flex-col sm:flex-row gap-4 mb-12">
                    <a href="{% url 'about' %}" style="display: inline-flex; align-items: center; justify-content: center; font-weight: 500; border-radius: 0.375rem; transition: all 0.3s ease; outline: none; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); padding: 0.75rem 1.5rem; font-size: 1.125rem; background: white; color: #047857; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);" onmouseover="this.style.backgroundColor='#f9fafb'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)';" onmouseout="this.style.backgroundColor='white'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)';" onfocus="this.style.boxShadow='0 0 0 2px #10b981';">
                        {% trans 'Learn More' %}
                    </a>
                    <a href="{% url 'contact' %}" class="inline-flex items-center justify-center px-6 py-3 bg-white/20 hover:bg-white/30 text-white font-semibold rounded-lg border-2 border-white shadow-lg transition-all duration-300 hover:shadow-xl hover:scale-105 backdrop-blur-sm">
                        {% trans 'Contact Us' %}
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
    <!-- Services Section with Static 3-Card Layout -->
    <section class="pt-4 pb-8 bg-gradient-subtle rounded-xl shadow-sm mb-8 border border-emerald-100">
        <div class="container mx-auto px-4 max-w-7xl">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">How can we serve you?</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">Access government services, request assistance, and participate in community programs through our digital platform.</p>
            </div>

            <!-- Services Grid - All 3 Cards Visible -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8" x-data="serviceCards()">
                <!-- Service Card 1: TDIF Projects (Left) -->
                <div class="bg-white rounded-lg border border-gray-100 overflow-hidden focus-ring transition-all duration-300 flex flex-col service-card"
                     @mouseenter="highlightCard(0)"
                     @mouseleave="clearHighlight()"
                     tabindex="0"
                     role="region"
                     aria-label="TDIF Projects service card">
                    <div class="p-6 flex flex-col flex-grow">
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">TDIF Projects</h3>
                        <p class="text-gray-600 mb-4 flex-grow">Access Transitional Development Impact Fund projects focused on infrastructure and community development.</p>
                        <div class="mt-auto flex justify-center">
                            <a href="{% url 'tdif_projects' %}" class="inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg shadow-md transition-all duration-200 min-h-[44px]" style="background: linear-gradient(135deg, #1e40af 0%, #059669 100%); display: inline-flex; align-items: center; justify-content: center;" onmouseover="this.style.background='linear-gradient(135deg, #1e3a8a 0%, #047857 100%)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 15px -3px rgba(0, 0, 0, 0.1)';" onmouseout="this.style.background='linear-gradient(135deg, #1e40af 0%, #059669 100%)'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                Explore Projects
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Service Card 2: Explore Programs (Center - HIGHLIGHTED BY DEFAULT) -->
                <div class="bg-white rounded-lg border border-gray-100 overflow-hidden focus-ring transition-all duration-300 flex flex-col service-card is-center"
                     @mouseenter="highlightCard(1)"
                     @mouseleave="clearHighlight()"
                     tabindex="0"
                     role="region"
                     aria-label="Explore Our Programs service card (featured)">
                    <div class="p-6 flex flex-col flex-grow">
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">Explore Our Programs</h3>
                        <p class="text-gray-600 mb-4 flex-grow">Discover and access programs and services directly provided by our office to address community needs.</p>
                        <div class="mt-auto flex justify-center">
                            <a href="{% url 'programs' %}" class="inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg shadow-md transition-all duration-200 min-h-[44px]" style="background: linear-gradient(135deg, #1e40af 0%, #059669 100%); display: inline-flex; align-items: center; justify-content: center;" onmouseover="this.style.background='linear-gradient(135deg, #1e3a8a 0%, #047857 100%)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 15px -3px rgba(0, 0, 0, 0.1)';" onmouseout="this.style.background='linear-gradient(135deg, #1e40af 0%, #059669 100%)'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                Explore Programs
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Service Card 3: Ministry Programs (Right) -->
                <div class="bg-white rounded-lg border border-gray-100 overflow-hidden focus-ring transition-all duration-300 flex flex-col service-card"
                     @mouseenter="highlightCard(2)"
                     @mouseleave="clearHighlight()"
                     tabindex="0"
                     role="region"
                     aria-label="Ministry Programs service card">
                    <div class="p-6 flex flex-col flex-grow">
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">Ministry Programs</h3>
                        <p class="text-gray-600 mb-4 flex-grow">Discover curated ministry programs designed for efficient access and streamlined service delivery.</p>
                        <div class="mt-auto flex justify-center">
                            <a href="{% url 'accessible_ministry_programs' %}" class="inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white rounded-lg shadow-md transition-all duration-200 min-h-[44px]" style="background: linear-gradient(135deg, #1e40af 0%, #059669 100%); display: inline-flex; align-items: center; justify-content: center;" onmouseover="this.style.background='linear-gradient(135deg, #1e3a8a 0%, #047857 100%)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 15px -3px rgba(0, 0, 0, 0.1)';" onmouseout="this.style.background='linear-gradient(135deg, #1e40af 0%, #059669 100%)'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">
                                Discover Programs
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Announcements Section -->
    <section class="py-16 bg-white rounded-xl shadow-sm mb-12 border border-slate-200">
        <div class="container mx-auto px-4 max-w-7xl">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-800 mb-2">Latest Updates</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">Stay informed about the latest activities, programs, and parliamentary updates from Tarbiyyah.</p>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8" x-data="staggerAnimation({staggerDelay: 200})">
                {% for announcement in announcements %}
                <!-- Announcement {{ forloop.counter }} -->
                <div class="bg-white rounded-lg shadow-sm overflow-hidden border border-gray-100 animate-fade-in-up hover-lift focus-ring flex flex-col" 
                     tabindex="0"
                     x-data="hoverAnimation()">
                    <div class="h-48 bg-gray-200 relative overflow-hidden">
                        {% if announcement.image %}
                        <img src="{{ announcement.image.url }}" alt="{{ announcement.title }}" class="w-full h-full object-cover">
                        {% else %}
                        <span class="text-gray-400 flex items-center justify-center w-full h-full">Announcement Image</span>
                        {% endif %}
                        <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 transition-opacity duration-300"
                             :class="{ 'opacity-100': isHovered }"
                             @mouseenter="mouseenter()"
                             @mouseleave="mouseleave()"></div>
                    </div>
                    <div class="p-6 flex flex-col flex-grow">
                        <div class="flex items-center mb-3">
                            {% include 'components/atoms/badge.html' with variant=announcement.get_category_color text=announcement.get_category_display %}
                            <span class="text-gray-500 text-sm ml-auto">{{ announcement.published_date|date:"M d, Y" }}</span>
                        </div>
                        <h3 class="text-xl font-semibold text-slate-800 mb-2">{{ announcement.title }}</h3>
                        <p class="text-slate-600 mb-4 flex-grow">{{ announcement.excerpt|default:announcement.content|truncatechars:200 }}</p>
                        <a href="{{ announcement.get_absolute_url }}" style="display: inline-flex; align-items: center; color: #059669; font-weight: 500; transition: all 0.3s ease; margin-top: auto;" onmouseover="this.style.color='#047857';" onmouseout="this.style.color='#059669';" class="group">
                            Read More
                            <i style="margin-left: 0.5rem; transition: transform 0.3s ease;" class="fas fa-arrow-right group-hover:translate-x-1"></i>
                        </a>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            <div class="text-center mt-10">
                <a href="{% url 'announcements' %}" style="display: inline-flex; align-items: center; justify-content: center; font-weight: 500; border-radius: 0.375rem; transition: all 0.3s ease; outline: none; padding: 0.75rem 1.5rem; font-size: 1.125rem; background: linear-gradient(135deg, #1e40af 0%, #059669 100%); color: white;" onmouseover="this.style.background='linear-gradient(135deg, #1e3a8a 0%, #047857 100%)'; this.style.boxShadow='0 0 25px rgba(5, 150, 105, 1), 0 8px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)';" onmouseout="this.style.background='linear-gradient(135deg, #1e40af 0%, #059669 100%)'; this.style.boxShadow='none';">View All Updates</a>
            </div>
        </div>
    </section>
{% endblock %}
